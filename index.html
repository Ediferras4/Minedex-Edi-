
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MiniDEX ‚Äî Edi (ARC Testnet)</title>

<style>
  :root{
    --bg-dark:#0b0f12;
    --card:#0f1417;
    --muted:#9aa3ad;
    --accent:#00e9a0;
    --glass: rgba(255,255,255,0.03);
    --text:#e6eef1;
  }
  body{
    margin:0;font-family:Inter,Arial,Helvetica,sans-serif;
    background:var(--bg-dark);color:var(--text);-webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;padding:22px;
  }
  .wrap{max-width:920px;margin:0 auto;}
  header{display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{
    width:60px;height:60px;border-radius:10px;object-fit:cover;
    background:linear-gradient(135deg,#071018 0,#122028 100%);box-shadow:0 6px 20px rgba(0,0,0,0.6);
  }
  .title{font-size:20px;font-weight:700;letter-spacing:0.2px}
  .subtitle{font-size:13px;color:var(--muted);margin-top:2px}
  .controls{display:flex;gap:8px;align-items:center}

  .network-badge{
    background:linear-gradient(90deg, rgba(0,233,160,0.12), rgba(0,233,160,0.06));
    color:var(--accent);padding:8px 12px;border-radius:999px;border:1px solid rgba(0,233,160,0.12);
    font-weight:600;font-size:13px;
  }

  .card{background:linear-gradient(180deg,var(--card),#0b1013);padding:16px;border-radius:14px;margin-top:18px;box-shadow:0 10px 30px rgba(2,8,12,0.6);}

  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}

  .theme-toggle{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
  .btn-primary{background:var(--accent);color:#081212;border:none;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}

  table{width:100%;border-collapse:collapse;margin-top:12px}
  th,td{padding:12px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.03)}
  th{color:var(--muted);font-size:13px}
  tr:hover{background:var(--glass)}

  .icon{
    display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:8px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));margin-right:8px;font-size:16px;
  }

  .center{display:flex;justify-content:center;align-items:center}
  .muted{color:var(--muted);font-size:13px}
  .small{font-size:13px;color:var(--muted)}

  /* modal */
  .modal{position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;background:rgba(2,6,8,0.6);z-index:50}
  .modal.open{display:flex}
  .modal-card{width:94%;max-width:420px;background:#061016;padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
  input,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);margin-top:8px}
  .modal-row{display:flex;gap:8px}
  .swap-result{margin-top:12px;padding:10px;background:rgba(255,255,255,0.02);border-radius:8px;color:var(--muted);font-size:14px}
  footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
  @media(max-width:560px){ .title{font-size:16px} .logo{width:52px;height:52px} th,td{padding:10px} }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <!-- logo file: se voc√™ colocou no root com o nome 20251204_210954.jpg -->
      <img src="./20251204_210954.jpg" alt="logo" class="logo" onerror="this.style.display='none'">
      <div>
        <div class="title">MiniDEX ‚Äî Edi</div>
        <div class="subtitle">Uma mini interface DEX para testes.</div>
      </div>
    </div>

    <div class="controls">
      <div class="network-badge" id="networkBadge">ARC TESTNET</div>
      <button class="theme-toggle" id="themeBtn">Modo Claro</button>
      <button class="btn-primary" id="connectBtn">Conectar Wallet</button>
    </div>
  </header>

  <div class="card">
    <div class="row" style="justify-content:space-between;align-items:center">
      <div>
        <div class="small">Tokens dispon√≠veis</div>
        <div style="font-weight:700;font-size:18px">Pool de Teste</div>
      </div>
      <div class="small muted" id="addrDisplay">Carteira: ‚Äî</div>
    </div>

    <table aria-label="Tabela de tokens">
      <thead>
        <tr><th>Token</th><th>Pre√ßo (fake)</th><th>Liquidez</th></tr>
      </thead>
      <tbody id="tokenTable">
        <tr>
          <td><span class="icon">üåç</span> ARC</td>
          <td>$0.12</td>
          <td>$120,000</td>
        </tr>
        <tr>
          <td><span class="icon">üí†</span> tUSDC</td>
          <td>$1.00</td>
          <td>$530,000</td>
        </tr>
        <tr>
          <td><span class="icon">üî•</span> tETH</td>
          <td>$3,100</td>
          <td>$98,000</td>
        </tr>
      </tbody>
    </table>

    <div style="display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;justify-content:center">
      <button class="btn-primary" id="openSwap">Fazer Swap (fake)</button>
      <button class="theme-toggle" id="toggleIcons">Alternar √çcones</button>
    </div>
  </div>

  <footer>Feito por Edi ‚Ä¢ Testnet ‚Ä¢ UI demonstrativa</footer>
</div>

<!-- modal swap -->
<div class="modal" id="swapModal">
  <div class="modal-card">
    <h3>Swap (simulado)</h3>
    <div class="small muted">Troca visual ‚Äî sem transa√ß√£o real</div>

    <label>De</label>
    <select id="fromToken">
      <option value="ARC">ARC</option>
      <option value="tUSDC">tUSDC</option>
      <option value="tETH">tETH</option>
    </select>

    <label>Para</label>
    <select id="toToken">
      <option value="tUSDC">tUSDC</option>
      <option value="ARC">ARC</option>
      <option value="tETH">tETH</option>
    </select>

    <label>Quantidade</label>
    <input id="swapAmount" type="number" placeholder="Quantidade" min="0" step="0.0001">

    <div style="display:flex;gap:8px;margin-top:10px">
      <button class="btn-primary" id="doSwap">Confirmar Swap</button>
      <button class="theme-toggle" id="closeSwap">Fechar</button>
    </div>

    <div class="swap-result" id="swapResult">Nenhuma opera√ß√£o realizada.</div>
  </div>
</div>

<!-- ethers.js -->
<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>

<script>
/* ---------- Config rede ARC Testnet (ajuste se necess√°rio) ---------- */
const ARC_TEST = {
  chainIdHex: "0x4cef52",       // 5042002
  chainName: "Arc Testnet",
  rpcUrls: ["https://rpc.testnet.arc.network"],
  nativeCurrency: { name: "USDC", symbol: "USDC", decimals: 6 },
  blockExplorerUrls: ["https://testnet.arcscan.app"]
};

/* ---------- Tokens (se quiser ler saldos, substitua os addresses) ---------- */
const TOKENS = [
  { name:"tUSDC", symbol:"tUSDC", address: "0x0000000000000000000000000000000000000000" },
  { name:"tETH", symbol:"tETH", address: "0x0000000000000000000000000000000000000000" }
];

/* ---------- UI handlers ---------- */
const themeBtn = document.getElementById('themeBtn');
const connectBtn = document.getElementById('connectBtn');
const addrDisplay = document.getElementById('addrDisplay');
const openSwap = document.getElementById('openSwap');
const swapModal = document.getElementById('swapModal');
const closeSwap = document.getElementById('closeSwap');
const doSwap = document.getElementById('doSwap');
const swapResult = document.getElementById('swapResult');
const toggleIconsBtn = document.getElementById('toggleIcons');

let dark = true;
function applyTheme() {
  if(dark){
    document.documentElement.style.setProperty('--bg-dark','#0b0f12');
    themeBtn.textContent = 'Modo Claro';
  } else {
    document.documentElement.style.setProperty('--bg-dark','#f6f8f9');
    themeBtn.textContent = 'Modo Escuro';
  }
}
themeBtn.addEventListener('click',()=>{
  dark = !dark;
  if(dark){
    document.body.style.background = 'var(--bg-dark)';
    document.body.style.color = 'var(--text)';
  } else {
    document.body.style.background = '#f7f8fa';
    document.body.style.color = '#102027';
  }
  applyTheme();
});
applyTheme();

/* toggle icons -> alternate emoji / initials */
let icons = true;
toggleIconsBtn.addEventListener('click', ()=>{
  const els = document.querySelectorAll('.icon');
  if(icons){
    els.forEach((el)=> el.innerHTML = '<strong style="font-size:13px">A</strong>');
    icons = false;
    toggleIconsBtn.textContent = '√çcones Emojis';
  } else {
    els[0].innerHTML = 'üåç'; els[1].innerHTML = 'üí†'; els[2].innerHTML = 'üî•';
    icons = true;
    toggleIconsBtn.textContent = 'Alternar √çcones';
  }
});

/* ---------- Swap modal ---------- */
openSwap.addEventListener('click', ()=> swapModal.classList.add('open'));
closeSwap.addEventListener('click', ()=> swapModal.classList.remove('open'));

doSwap.addEventListener('click', ()=>{
  const from = document.getElementById('fromToken').value;
  const to = document.getElementById('toToken').value;
  const amt = Number(document.getElementById('swapAmount').value);
  if(!amt || amt <= 0){ swapResult.textContent = 'Digite uma quantidade v√°lida.'; return; }
  if(from === to){ swapResult.textContent = 'Escolha tokens diferentes.'; return; }
  // simula√ß√£o simples: taxa fixa 0.3%
  const received = amt * 0.997; 
  swapResult.textContent = `Simulado: trocando ${amt} ${from} ‚Üí receber ~${received.toFixed(6)} ${to} (taxa 0.3%).`;
});

/* ---------- Connect Wallet (ethers) ---------- */
async function ensureArcNetwork(provider) {
  try {
    await provider.send("wallet_switchEthereumChain", [{ chainId: ARC_TEST.chainIdHex }]);
  } catch (switchError) {
    try {
      await provider.send("wallet_addEthereumChain", [{
        chainId: ARC_TEST.chainIdHex,
        chainName: ARC_TEST.chainName,
        rpcUrls: ARC_TEST.rpcUrls,
        nativeCurrency: ARC_TEST.nativeCurrency,
        blockExplorerUrls: ARC_TEST.blockExplorerUrls
      }]);
    } catch (err) {
      console.error('Erro add network', err);
      alert('N√£o foi poss√≠vel adicionar/trocar a rede na sua wallet.');
    }
  }
}

async function connectWallet() {
  if(!window.ethereum){ alert('Nenhuma carteira detectada. Abra via MetaMask Mobile in-app ou use um navegador com Web3.'); return; }
  const provider = new ethers.providers.Web3Provider(window.ethereum, "any");
  try {
    await provider.send("eth_requestAccounts", []);
    const signer = provider.getSigner();
    const address = await signer.getAddress();
    addrDisplay.textContent = 'Carteira: ' + address.slice(0,6) + '...' + address.slice(-4);
    // tentar trocar/adicionar a rede Arc Testnet
    await ensureArcNetwork(provider.provider);
    // opcional: ler saldos ERC20 (se tokens tiverem endere√ßo v√°lido)
    // aqui s√≥ mostramos que conectou
    connectBtn.textContent = 'Conectado';
  } catch (err) {
    console.error(err);
    alert('Conex√£o recusada ou erro: ' + (err.message || err));
  }
}

connectBtn.addEventListener('click', connectWallet);

/* ---------- Quick check: if metaMask changes accounts/network, update UI ---------- */
if(window.ethereum){
  window.ethereum.on && window.ethereum.on('accountsChanged', (accounts)=> {
    if(accounts.length) addrDisplay.textContent = 'Carteira: ' + accounts[0].slice(0,6) + '...' + accounts[0].slice(-4);
    else addrDisplay.textContent = 'Carteira: ‚Äî';
  });
  window.ethereum.on && window.ethereum.on('chainChanged', (chainId)=>{
    document.getElementById('networkBadge').textContent = chainId === ARC_TEST.chainIdHex ? 'ARC TESTNET' : 'Rede: ' + chainId;
  });
}
</script>
</body>
</html>
